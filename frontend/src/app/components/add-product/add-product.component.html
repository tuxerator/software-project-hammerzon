<div class="container">
  <div class="bg-dark text-white">
    <article class="card-body row gy-3">
      <h4
        class="card-title mt-3 text-center text-white">{{productId ? 'Produkt bearbeiten' : 'Produkt hinzufügen'}}</h4>
      <form [formGroup]="addProductForm" class="needs-validation col" novalidate>

        <!--Produktname-->
        <div [class.was-validated]="addProductForm.controls['productName'].touched"
             class="input-group has-validation">
          <span class="input-group-text" id="basic-addon1"> <i class="bi bi-tag-fill"></i> </span>
          <input class="form-control" formControlName="productName" placeholder="Produktname" required type="text">
          <div *ngIf="!addProductForm.controls['productName']?.invalid" class="valid-feedback was-validated">Gültiger
            Produktname.
          </div>
          <div *ngIf="addProductForm.controls['productName']?.invalid" class="invalid-feedback was-validated">
            Produktname wird erwartet.
          </div>
        </div>

        <!--Preis-->
        <div [class.was-validated]="addProductForm.controls['prize'].touched" class="col input-group has-validation">
          <span class="input-group-text" id="basic-addon1"> <i class="bi bi-briefcase-fill"></i></span>
          <input class="form-control" formControlName="prize" placeholder="Preis" required type="text">
          <span class="input-group-text"> <i class="bi bi-currency-euro"></i>/std</span>
          <div *ngIf="!addProductForm.controls['prize']?.invalid" class="valid-feedback was-validated">Gültiger Preis.
          </div>
          <div *ngIf="addProductForm.controls['prize']?.invalid" class="invalid-feedback was-validated">Preis wird
            erwartet.
          </div>
        </div>

        <!--Beschreibung-->
        <div [class.was-validated]="addProductForm.controls['description'].touched"
             class="col input-group has-validation">
          <span class="input-group-text" id="basic-addon1"> <i class="bi bi-file-earmark-text-fill"></i> </span>
          <textarea class="form-control" formControlName="description" placeholder="Beschreibung" required rows="3"
                    type="text"></textarea>
          <div *ngIf="!addProductForm.controls['description']?.invalid" class="valid-feedback was-validated">Gültige
            Beschreibung.
          </div>
          <div *ngIf="addProductForm.controls['description']?.invalid" class="invalid-feedback was-validated">
            Beschreibung wird erwartet.
          </div>
        </div>

        <div class="col">
          <label class="form-label" for="durationInput">Dauer</label>
          <div
            [class.was-validated]="addProductForm.controls['durationHour'].touched ||addProductForm.controls['durationMinute'].touched"
            class="input-group mb-3 has-validation col-auto"
            id="durationInput">
            <span class="input-group-text"><i class="bi bi-clock-fill"></i> </span>
            <input aria-label="Stunden" class="form-control" formControlName="durationHour" placeholder="Stunden"
                   required type="text">
            <span class="input-group-text">std.</span>
            <input aria-label="Minuten" class="form-control" formControlName="durationMinute" placeholder="Minuten"
                   required type="text">
            <span class="input-group-text">min.</span>
            <div
              *ngIf="!addProductForm.controls['durationHour']?.invalid && !addProductForm.controls['durationMinute']?.invalid"
              class="valid-feedback was-validated">Gültige Dauer
            </div>
            <div
              *ngIf="addProductForm.controls['durationHour']?.invalid || addProductForm.controls['durationMinute']?.invalid"
              class="invalid-feedback was-validated">Für Stunden und Mintuen werden Zahlen erwartet
            </div>
          </div>
        </div>

        <!-- Availability -->
        <app-availability-picker (newAvailability)="addAvailability($event)"
                                 [form]="availabilityGroup"></app-availability-picker>

        <!-- Hindrance -->
        <app-hindrance-picker (newHindrance)="addHindrance($event)" [form]="hindranceGroup"
                              [markDisabled]="isOutsideAvailability()"></app-hindrance-picker>

        <!-- Bild hinzufügen -->
        <label for="appointmentInputs" class="form-label">Product Bild</label>
        <div class="form-group input-group mb-3">
          <input #imageInput (change)="uploadImage(imageInput)" class="form-control" id="inputGroupFile02" type="file">
          <label class="input-group-text" for="inputGroupFile02">Upload</label>
        </div>
        <span *ngIf="isChecked && !imageId" class="text-danger">Es muss ein Bild hochgeladen werden</span>

        <!-- Bild anzeigen -->
        <figure *ngIf="imageId" class="figure">
          <img src="/api/img/{{imageId}}" class="figure-img img-fluid rounded" alt="...">
          <figcaption class="figure-caption text-end">Product Bild</figcaption>
        </figure>


        <!--Produkt hinzufügen-->
        <div class="d-grid mt-4">
          <button class="btn btn-primary btn-block"
                  type="submit">{{productId ? 'Speichern' : 'Hinzufügen'}}
            <div *ngIf="uploading" class="spinner-border text-light" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </button>


        </div>
      </form>

    </article>
  </div>
</div>
